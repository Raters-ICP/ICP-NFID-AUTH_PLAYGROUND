(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[438],{8159:function(e,t,n){Promise.resolve().then(n.bind(n,5652))},3875:function(e,t,n){"use strict";var i,r;e.exports=(null==(i=n.g.process)?void 0:i.env)&&"object"==typeof(null==(r=n.g.process)?void 0:r.env)?n.g.process:n(3928)},3928:function(e){!function(){var t={229:function(e){var t,n,i,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(e){n=l}}();var a=[],c=!1,u=-1;function d(){c&&i&&(c=!1,i.length?a=i.concat(a):u=-1,a.length&&f())}function f(){if(!c){var e=o(d);c=!0;for(var t=a.length;t;){for(i=a,a=[];++u<t;)i&&i[u].run();u=-1,t=a.length}i=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new h(e,t)),1!==a.length||c||o(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var s=n[e]={exports:{}},l=!0;try{t[e](s,s.exports,i),l=!1}finally{l&&delete n[e]}return s.exports}i.ab="//";var r=i(229);e.exports=r}()},5652:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n(7573),r=n(7653),s=n(1715),l=n(6385).lW;function o(){let{isLoggingIn:e,login:t,clear:n,identity:o,loginStatus:a}=(0,s.BM)(),[c,u]=(0,r.useState)(""),[d,f]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[p,v]=(0,r.useState)(""),[y,b]=(0,r.useState)(!1),w=()=>{if(o){let e=o._delegation;e?u(JSON.stringify(e)):console.error("Delegation is undefined")}else console.error("Identity is undefined or null")};(0,r.useEffect)(()=>{o&&w()},[o]);let j=async()=>{if(o){let{privateKey:e}=o._inner._keyPair,t=o.getPrincipal()._arr;window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},e,t).then(e=>{v(Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join(""))})}else console.log("Объект с таким ключом не найден.")},S=async()=>{if(o){let e=new Uint8Array(l.from(h,"hex")),t=new Uint8Array(l.from(d,"hex")),n=o._principal._arr;try{let i=await crypto.subtle.importKey("spki",e,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"]),r=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},i,t,n);b(r)}catch(e){b(!1),console.error(e)}}};return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)("div",{children:o?(0,i.jsxs)("div",{className:"flex flex-row gap-20",children:[(0,i.jsx)("button",{className:"p-6 bg-red-500 rounded-sm",onClick:()=>{o&&(u(""),n())},children:"Logout"}),(0,i.jsx)("button",{className:"p-6 bg-green-500 rounded-sm",onClick:w,children:"Get Delegation"}),(0,i.jsx)("button",{className:"p-6 bg-blue-500 rounded-sm",onClick:j,children:"Sign"})]}):(0,i.jsx)("button",{className:"p-6 bg-blue-500 rounded-sm",onClick:t,children:"Connect ICP"})}),(0,i.jsxs)("div",{className:"flex flex-col gap-6 mt-10",children:[(0,i.jsx)("p",{children:"Delegation"}),(0,i.jsx)("textarea",{value:c,className:"text-black rounded-md w-96 h-32 p-6",disabled:!0})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-6 mt-10",children:[(0,i.jsx)("p",{children:"Signed principal"}),(0,i.jsx)("textarea",{className:"text-black rounded-md w-96 h-32 p-6",disabled:!0,value:p})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-6 mt-6 items-center",children:[(0,i.jsx)("p",{children:"Compare sign"}),(0,i.jsxs)("div",{className:"flex flex-row gap-6",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("label",{className:"mb-2 text-white",children:"Sign"}),(0,i.jsx)("textarea",{id:"sign",placeholder:"sign",className:"text-black rounded-md w-96 h-32 p-6",value:d,onChange:e=>f(e.target.value)})]}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("label",{className:"mb-2",children:"Public Key"}),(0,i.jsx)("textarea",{id:"pubkey",placeholder:"public key",className:"text-black rounded-md w-96 h-32 p-6",value:h,onChange:e=>g(e.target.value)})]})]}),(0,i.jsx)("button",{className:"p-6 bg-green-500 rounded-sm max-w-24",onClick:S,children:"Verify"}),(0,i.jsx)("div",{className:"p-3 text-sm ".concat(y?"bg-green-500":"bg-red-500"),children:y?"True":"False"})]})]})}var a=n(7659);function c(){return(0,i.jsxs)("main",{className:"flex min-h-screen flex-col items-center gap-24 p-24",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,i.jsx)("div",{children:"ICP test playground or"}),(0,i.jsx)(a.default,{href:"/",className:"text-blue-500",children:"NFID playground"})]}),(0,i.jsx)(o,{})]})}},1715:function(e,t,n){"use strict";n.d(t,{BM:function(){return a},tV:function(){return c}});var i=n(7653),r=n(439),s=n(7573),l=n(3875),o=(0,i.createContext)(void 0),a=()=>{let e=(0,i.useContext)(o);if(!e)throw Error("useInternetIdentity must be used within an InternetIdentityProvider");return e};function c({createOptions:e,loginOptions:t,children:n}){let[a,c]=(0,i.useState)({isInitializing:!0,loginStatus:"idle"});function u(){let e=a.authClient?.getIdentity();if(!e)throw Error("Identity not found after successful login");c(t=>({...t,loginStatus:"success",identity:e}))}function d(e){c(t=>({...t,loginStatus:"error",loginError:Error(e)}))}async function f(){if(!a.authClient)throw Error("Auth client not initialized");if(await a.authClient.isAuthenticated())throw Error("User is already authenticated");c(e=>({...e,loginStatus:"logging-in"}));let e={identityProvider:l.env.II_URL,onSuccess:u,onError:d,maxTimeToLive:BigInt(36e11),...t};a.authClient.login(e)}async function h(){if(!a.authClient)throw Error("Auth client not initialized");await a.authClient.logout(),c(e=>({...e,identity:void 0,loginStatus:"idle"}))}return(0,i.useEffect)(()=>{(async()=>{let t={idleOptions:{disableDefaultIdleCallback:!0,disableIdle:!0,...e?.idleOptions},...e},n=await r.AuthClient.create(t),i=await n.isAuthenticated();if(c(e=>({...e,authClient:n})),i){let e=n.getIdentity();e&&c(t=>({...t,identity:e}))}c(e=>({...e,isInitializing:!1}))})()},[e]),(0,s.jsx)(o.Provider,{value:{isInitializing:a.isInitializing,login:f,loginStatus:a.loginStatus,loginError:a.loginError,isLoggingIn:"logging-in"===a.loginStatus,isLoginError:"error"===a.loginStatus,isLoginSuccess:"success"===a.loginStatus,isLoginIdle:"idle"===a.loginStatus,clear:h,identity:a.identity},children:n})}}},function(e){e.O(0,[439,659,293,286,744],function(){return e(e.s=8159)}),_N_E=e.O()}]);