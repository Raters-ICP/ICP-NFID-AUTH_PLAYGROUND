(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4719:function(e,t,n){Promise.resolve().then(n.bind(n,8192))},8192:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(7573),l=n(7659),s=n(7653),i=n(323),r=n(6385).lW;function c(){let[e,t]=(0,s.useState)(null),[n,l]=(0,s.useState)(""),[c,o]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),[x,m]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[h,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{!async function(){try{let e=await i.NFID.init({application:{name:"NFID Playground",logo:"https://dev.nfid.one/static/media/id.300eb72f3335b50f5653a7d6ad5467b3.svg"}});t(e),u(e.isAuthenticated);let n=e.getIdentity();l(JSON.stringify(n))}catch(e){console.error("Failed to initialize NFID:",e)}}()},[]);let b=async()=>{e&&(await e.logout(),u(!1))},N=async()=>{e&&(e.getDelegation({}),u(!0))},y=async()=>{if(e&&e.isAuthenticated){let t=e.getIdentity();l(JSON.stringify(t)),console.log(t)}},j=async()=>{let e=indexedDB.open("nfid-auth-client-db",1),t=new TextEncoder,a={name:"ECDSA",hash:{name:"SHA-256"}};e.onsuccess=function(e){let l=e.target.result.transaction(["ic-keyval"],"readonly").objectStore("ic-keyval").get("identity");l.onerror=function(e){console.error("Ошибка получения объекта:",e.target.errorCode)},l.onsuccess=function(e){let l=e.target.result;if(l){let e=JSON.parse(n),{privateKey:s}=l,i=t.encode(e._principal.__principal__).buffer;window.crypto.subtle.sign(a,s,i).then(e=>{o(Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join(""))})}else console.log("Объект с таким ключом не найден.")}}},v=async()=>{let e=JSON.parse(n),t=new Uint8Array(r.from(f,"hex")),a=new Uint8Array(r.from(x,"hex")),l=new TextEncoder().encode(e._principal.__principal__);try{let e=await crypto.subtle.importKey("spki",t,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"]),n=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},e,a,l);g(n)}catch(e){g(!1),console.error(e)}};return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{children:d?(0,a.jsxs)("div",{className:"flex flex-row gap-20",children:[(0,a.jsx)("button",{className:"p-6 bg-red-500 rounded-sm",onClick:b,children:"Logout"}),(0,a.jsx)("button",{className:"p-6 bg-green-500 rounded-sm",onClick:y,children:"Get Delegation"}),(0,a.jsx)("button",{className:"p-6 bg-blue-500 rounded-sm",onClick:j,children:"Sign"})]}):(0,a.jsx)("button",{className:"p-6 bg-blue-500 rounded-sm",onClick:N,children:"Connect NFID"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-6 mt-10",children:[(0,a.jsx)("p",{children:"Delegation"}),(0,a.jsx)("textarea",{className:"text-black rounded-md w-96 h-32 p-6",disabled:!0,value:n})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-6 mt-10",children:[(0,a.jsx)("p",{children:"Signed principal"}),(0,a.jsx)("textarea",{className:"text-black rounded-md w-96 h-32 p-6",disabled:!0,value:c})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-6 mt-6 items-center",children:[(0,a.jsx)("p",{children:"Compare sign"}),(0,a.jsxs)("div",{className:"flex flex-row gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"mb-2 text-white",children:"Sign"}),(0,a.jsx)("textarea",{id:"sign",placeholder:"sign",className:"text-black rounded-md w-96 h-32 p-6",value:x,onChange:e=>m(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"mb-2",children:"Public Key"}),(0,a.jsx)("textarea",{id:"pubkey",placeholder:"public key",className:"text-black rounded-md w-96 h-32 p-6",value:f,onChange:e=>p(e.target.value)})]})]}),(0,a.jsx)("button",{className:"p-6 bg-green-500 rounded-sm max-w-24",onClick:v,children:"Verify"}),(0,a.jsx)("div",{className:"p-3 text-sm ".concat(h?"bg-green-500":"bg-red-500"),children:h?"True":"False"})]})]})}function o(){return(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-center gap-24 p-24",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,a.jsx)("div",{children:"NFID test playground or"}),(0,a.jsx)(l.default,{href:"/icp",className:"text-blue-500",children:"ICP playground"})]}),(0,a.jsx)(c,{})]})}}},function(e){e.O(0,[439,659,323,293,286,744],function(){return e(e.s=4719)}),_N_E=e.O()}]);